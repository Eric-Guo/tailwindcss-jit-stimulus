<%= render partial: 'shared/header', locals: {} -%>

<p class="px-4 sm:px-6 lg:px-8 pt-8 text-sm text-gray-500"><%= link_to '首页', root_path -%> > <span class="text-black">供应商列表</span></p>

<div data-controller="project-form-list">
  <div class="flex flex-row px-4 sm:px-6 lg:px-8">
    <section class="w-full flex flex-col">
      <%# 供应商 %>
      <div class="mt-7 mb-4 border-b-2 border-gray-100 border-solid pb-3">
        <span class="text-2xl font-bold ml-px mr-2 under-text-border" style="padding-bottom: 0.9rem">供应商列表</span>
        <span class="text-xl font-light">Manufacturer List</span>
      </div>
    </section>
  </div>

  <%= form_tag manufacturers_path, class: 'px-4 sm:px-6 lg:px-8 mt-2 select-none', method: :get, data: {
    project_form_list_target: 'form',
    turbo_frame: 'manufacturer_list',
  } do %>
    <div class="flex flex-row justify-between border border-gray-200 bg-gray-100">
      <div class="flex flex-row w-1/3 p-1">
        <input
          name="q"
          type="text"
          placeholder="东丽石业/真石漆"
          class="block flex-grow bg-transparent text-base placeholder-gray-300 border-0 focus:outline-none focus:ring-gray-100 focus:border-gray-100 focus:ring-offset-gray-100"
          autocomplete="off"
        />
        <button type="submit" class="cursor-pointer">
          <svg xmlns="http://www.w3.org/2000/svg" class="flex-none mx-4 my-3 h-6 w-6 text-gray-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
          </svg>
        </button>
      </div>
      <div class="flex flex-row w-1/3 p-1 cursor-pointer" data-action="click->project-form-list#togglePanel" data-project-form-list-target="materialPanelControl">
        <p class="flex-none pl-4 pr-2 my-3 text-gray-500 border-l border-gray-300">
          <span style="padding-bottom: 1.1rem">材料</span>
        </p>
        <svg xmlns="http://www.w3.org/2000/svg" class="flex-none my-4 h-4 w-4 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path fill="currentColor" d="M20 8H4L12 16L20 8Z"></path>
        </svg>
      </div>
      <div class="flex flex-row w-1/3 p-1 cursor-pointer" data-action="click->project-form-list#togglePanel" data-project-form-list-target="areaPanelControl">
        <p class="flex-none pl-4 pr-2 my-3 text-gray-500 border-l border-gray-300">
          <span class="<%= @panel_name == 'area' ? 'under-text-border' : '' -%>" style="padding-bottom: 1.1rem">服务区域</span>
        </p>
        <svg xmlns="http://www.w3.org/2000/svg" class="flex-none my-4 h-4 w-4 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path fill="currentColor" d="<%= @panel_name == 'area' ? 'M20 16H4L12 8L20 16Z' : 'M20 8H4L12 16L20 8Z' -%>"></path>
        </svg>
      </div>
    </div>
    <div class="hidden" data-project-form-list-target="panel">
      <div class="hidden" data-project-form-list-target="materialPanel">
        <div class="flex flex-row text-gray-700 border-b border-l border-r border-gray-200">
          <div class="w-80"></div>
          <div class="grid grid-flow-row grid-cols-6 w-full">
            <% @tree_materials.each_with_index do |material, index| %>
              <button
                type="button"
                class="py-4 <%= index == 0 ? 'font-bold' : '' %>"
                data-id="<%= material[:id] %>"
                data-children="<%= material[:children].to_json %>"
                data-project-form-list-target="material1"
                data-action="click->project-form-list#activeMaterial1"
              >
                <%= material[:title] -%>
              </button>
            <% end %>
          </div>
        </div>
        <div class="flex flex-row text-gray-700 border-b border-l border-r border-gray-200 bg-gray-50">
          <div class="w-80">
            <div class="my-4 ml-8 flex items-start">
              <input
                id="checkbox-select-material-all"
                type="checkbox"
                class="mt-1 focus:ring-gray-50 text-gray-600 border-gray-300"
                data-project-form-list-target="materialAllCheckbox"
                data-action="change->project-form-list#changeMaterialAllCheckbox"  
              >
              <label for="checkbox-select-material-all" class="font-medium text-gray-700 ml-2 mt-px">全部</label>
            </div>
          </div>
          <div id="material_details" class="grid grid-flow-row grid-cols-6 w-full py-1" data-project-form-list-target="material2List"></div>
        </div>
      </div>
      <div class="flex flex-row text-gray-700 border-b border-l border-r border-gray-200 bg-gray-50 hidden" data-project-form-list-target="areaPanel">
        <div class="w-80">
          <div class="my-4 ml-8 flex items-start">
            <input
              id="checkbox-select-location-all"
              type="checkbox"
              class="mt-1 focus:ring-gray-50 text-gray-600 border-gray-300"
              data-project-form-list-target="areaAllCheckbox"
              data-action="change->project-form-list#changeAreaAllCheckbox"  
            >
            <label for="checkbox-select-location-all" class="font-medium text-gray-700 ml-2 mt-px">全部</label>
          </div>
        </div>
        <div class="grid grid-flow-row grid-cols-6 w-full py-1">
          <% Manufacturer.manufacturer_locations.each do |area| %>
            <div class="my-2.5 flex items-start">
              <input
                id="<%= "location-#{area.area_id}" -%>"
                name="l[]"
                value="<%= area.area_id -%>"
                type="checkbox"
                class="mt-1 focus:ring-gray-50 text-gray-600 border-gray-300"
                data-project-form-list-target="areaItemCheckbox"
                data-action="change->project-form-list#changeAreaItemCheckbox"
              >
              <label for="<%= "location-#{area.area_id}" -%>" class="text-gray-700 ml-2 mt-px"><%= area.area_title -%></label>
            </div>
          <% end %>
        </div>
      </div>
      <div class="flex flex-row text-gray-700 border-b border-l border-r border-gray-200 bg-gray-50">
        <div class="w-80">
          <div class="my-4 ml-8">
            高级筛选
          </div>
        </div>
        <div class="grid grid-flow-row grid-cols-6 w-full py-1">
          <div class="my-2.5 flex items-start">
            <input id="chk-sample-is-allow" name="sample_is_allow" type="checkbox" class="mt-1 focus:ring-gray-50 text-gray-600 border-gray-300" data-action="change->project-form-list#submitForm">
            <label for="chk-sample-is-allow" class="text-gray-700 ml-2 mt-px">是否愿意提供样品</label>
          </div>
          <div class="my-2.5 flex items-start">
            <input id="chk-has-related-cases" name="has_related_cases" type="checkbox" class="mt-1 focus:ring-gray-50 text-gray-600 border-gray-300" data-action="change->project-form-list#submitForm">
            <label for="chk-ecm-files" class="text-gray-700 ml-2 mt-px">有关联案例</label>
          </div>
          <div class="my-2.5 flex items-start">
            <input id="chk-has-cooperate-th" name="has_cooperate_th" type="checkbox" class="mt-1 focus:ring-gray-50 text-gray-600 border-gray-300" data-action="change->project-form-list#submitForm">
            <label for="chk-has-sample" class="text-gray-700 ml-2 mt-px">与天华合作过</label>
          </div>
        </div>
      </div>
    </div>
  <% end %>

  <%= turbo_frame_tag :manufacturer_list, src: manufacturers_path(turbo: true), data: {
    controller: 'turbo-frame',
    project_form_list_target: 'list',
  } %>
</div>