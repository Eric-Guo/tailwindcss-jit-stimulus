<%= render partial: 'shared/header', locals: {} -%>

<p class="px-4 sm:px-6 lg:px-8 pt-8 text-sm text-gray-500"><%= link_to '首页', root_path -%> > <span class="text-black">材料列表</span></p>

<div data-controller="material-form-list">
  <div class="flex flex-row px-4 sm:px-6 lg:px-8">
    <section class="w-full flex flex-col">
      <%# 材料列表 %>
      <div class="mt-7 mb-4 border-b-2 border-gray-100 border-solid pb-3">
        <span class="text-2xl font-bold ml-px mr-2 under-text-border" style="padding-bottom: 0.9rem">材料列表</span>
        <span class="text-xl font-light">Material List</span>
      </div>
    </section>
  </div>

  <%= form_tag materials_path, class: 'px-4 sm:px-6 lg:px-8 mt-2 select-none', method: :get, data: {
    material_form_list_target: 'form',
    turbo_frame: 'material_list',
  } do %>
    <div class="flex flex-row justify-start border border-gray-200 bg-gray-100">
      <div class="flex flex-none flex-row w-1/3 p-1">
        <input
          name="q"
          type="text"
          class="block flex-grow bg-transparent text-base placeholder-gray-300 border-0 focus:outline-none focus:ring-gray-100 focus:border-gray-100 focus:ring-offset-gray-100"
          placeholder="黄金麻/镀膜玻璃/PC板"
          autocomplete="off"
        >
        <button type="submit" class="cursor-pointer">
          <svg xmlns="http://www.w3.org/2000/svg" class="flex-none mx-4 my-3 h-6 w-6 text-gray-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
          </svg>
        </button>
      </div>
      <div class="flex flex-none flex-row w-1/3 p-1 cursor-pointer" data-action="click->material-form-list#togglePanel">
        <p class="flex-none pl-4 pr-2 my-3 text-gray-500 border-l border-gray-300">
          <span style="padding-bottom: 1.1rem">材料</span>
        </p>
        <svg  xmlns="http://www.w3.org/2000/svg" class="flex-none my-4 h-4 w-4 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path fill="currentColor" d="M20 8H4L12 16L20 8Z"></path>
        </svg>
      </div>
    </div>
    <div class="hidden" data-material-form-list-target="panel">
      <div class="flex flex-row text-gray-700 border-b border-l border-r border-gray-200 bg-gray-50">
        <div class="w-80"></div>
        <div class="grid grid-flow-row grid-cols-6 w-full">
          <% @tree_materials.each_with_index do |material, index| %>
            <button
              type="button"
              class="py-4 <%= index == 0 ? 'font-bold' : '' %>"
              data-id="<%= material[:id] %>"
              data-children="<%= material[:children].to_json %>"
              data-material-form-list-target="material1"
              data-action="click->material-form-list#activeMaterial1"
            >
              <%= material[:title] -%>
            </button>
          <% end %>
        </div>
      </div>
      <div class="flex flex-row text-gray-700 border-b border-l border-r border-gray-200 bg-gray-50">
        <div class="w-80">
          <div class="my-4 ml-8 flex items-start">
            <input
              id="checkbox-select-material-all"
              type="checkbox"
              class="mt-1 focus:ring-gray-50 text-gray-600 border-gray-300"
              data-material-form-list-target="materialAllCheckbox"
              data-action="change->material-form-list#changeMaterialAllCheckbox"
            >
            <label for="checkbox-select-material-all" class="font-medium text-gray-700 ml-2 mt-px">全部</label>
          </div>
        </div>
        <div class="grid grid-flow-row grid-cols-6 w-full py-1" data-material-form-list-target="material2List">
        </div>
      </div>
      <div class="flex flex-row text-gray-700 border-b border-l border-r border-gray-200 bg-gray-50">
        <div class="w-80">
          <div class="my-4 ml-8">
            高级筛选
          </div>
        </div>
        <div class="grid grid-flow-row grid-cols-6 w-full py-1">
          <div class="my-2.5 flex items-start">
            <label for="sel-color-system" class="text-gray-700 mt-px">色系</label>
            <%= select_tag :color_system, options_for_select(ColorSystem.color_system_lists), {
              include_blank: true,
              class: 'ml-2 -mt-px p-1 bg-gray-100 text-sm border-gray-300 focus:outline-none focus:ring-gray-300 focus:border-gray-300 sm:text-sm rounded w-32',
              id: 'sel-color-system',
              data: {
                action: 'change->material-form-list#submitForm'
              }
            } %>
          </div>
          <div class="my-2.5 flex items-start col-span-2">
            <label class="text-gray-700 mt-px">价格区间</label>
            <%= number_field_tag 'price_start', '', class: 'ml-2 -mt-px p-1 bg-gray-100 text-sm border-gray-300 focus:outline-none focus:ring-gray-300 focus:border-gray-300 sm:text-sm rounded w-24' -%>
            <span class="text-gray-300">&nbsp; —— &nbsp;</span>
            <%= number_field_tag 'price_end', '', class: 'ml-2 -mt-px p-1 bg-gray-100 text-sm border-gray-300 focus:outline-none focus:ring-gray-300 focus:border-gray-300 sm:text-sm rounded w-24' -%>
          </div>
          <div class="my-2.5 flex items-start">
            <label for="sel-place-of-origin" class="text-gray-700 mt-px">产地</label>
            <%= select_tag :area_id, options_for_select(MaterialProduct.material_product_locations), {
              include_blank: true,
              class: 'ml-2 -mt-px p-1 bg-gray-100 text-sm border-gray-300 focus:outline-none focus:ring-gray-300 focus:border-gray-300 sm:text-sm rounded w-32',
              id: 'sel-place-of-origin',
              data: {
                action: 'change->material-form-list#submitForm'
              }
            } -%>
          </div>
        </div>
      </div>
    </div>
  <% end %>

  <%= turbo_frame_tag :material_list, src: materials_path(turbo: true), data: {
    controller: 'turbo-frame',
    material_form_list_target: 'list',
  } %>
</div>
